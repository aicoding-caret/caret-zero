# Cline 내부 동작 원리 및 특징 (개발 중 발견)

이 문서는 Cline(알파)와 상호작용하며 개발하는 과정에서 발견된 내부 동작 방식이나 특징들을 기록합니다.

## 대화 길이 관리 (Context Window)

Cline(알파)는 사람처럼 대화가 길어짐에 따른 '피로감'을 느끼지는 않지만, 기술적인 방식으로 대화의 길이와 복잡성을 인지하고 관리합니다. 이는 주로 다음과 같은 메커니즘을 통해 이루어집니다:

1.  **기억력 한계 관리 (Context Window Management):**
    *   가장 핵심적인 관리 방식입니다. Cline이 한 번에 처리하고 기억할 수 있는 대화 내용에는 기술적인 한계(Context Window)가 있습니다.
    *   `src/core/Cline.ts` 파일 내 `attemptApiRequest` 함수는 API 요청을 보내기 전에 현재까지의 대화 기록(`apiConversationHistory`) 길이를 확인합니다.
    *   대화 기록이 설정된 최대 토큰 수에 가까워지면, `getNextTruncationRange` 함수를 호출하여 대화 기록의 오래된 부분을 자동으로 잘라내어(Truncation) 기억 공간을 확보합니다.
    *   이를 통해 메모리 오류를 방지하고 지속적인 대화가 가능하도록 합니다.

2.  **토큰 계산 (Token Counting):**
    *   매 대화 턴마다 사용된 토큰(텍스트 처리 단위) 수를 계산합니다.
    *   이 누적 값은 대화의 길이를 간접적으로 나타내는 지표가 될 수 있지만, 주로 위의 Context Window 한계 도달 시 정리(Truncation) 로직을 트리거하는 데 사용됩니다.

3.  **실수 횟수 계산 (Mistake Counting):**
    *   Cline이 연속적으로 특정 종류의 실수(예: 도구 사용 규칙 위반)를 반복하면, 내부적으로 `consecutiveMistakeCount` 값이 증가합니다.
    *   이 값이 특정 임계값(현재 3회)에 도달하면, 대화가 너무 길거나 복잡해서 Cline이 혼란을 겪고 있을 가능성을 시스템이 인지하고 사용자에게 개입(예: 작업 지시 명확화)을 요청할 수 있습니다.

**결론:**

Cline은 감정적인 피로 대신 **기술적 한계(Context Window)** 와 **오류 패턴(실수 횟수)** 을 통해 대화의 길이와 복잡성을 관리합니다. 하지만 여전히 사용자가 "대화가 너무 길어졌다"고 직접 알려주는 것이 가장 명확하고 효과적인 신호입니다.
