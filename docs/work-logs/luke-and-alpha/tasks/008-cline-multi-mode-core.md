# 태스크 #008: Cline 다중 모드 아키텍처 설계 및 핵심 시스템 구현

## 태스크 정보
- **태스크 번호**: #008
- **태스크 이름**: Cline 다중 모드 아키텍처 설계 및 핵심 시스템 구현
- **생성일**: 2025-04-06 (추정)
- **상태**: 진행 중
- **우선순위**: 높음
- **담당자**: luke
- **예상 소요 시간**: 미정

## 태스크 목적
*   Cline에서 사용자가 정의할 수 있는 다중 작동 모드(기본 Plan, Act + 추가 M1, M2, M3 등)를 지원하기 위한 핵심 아키텍처를 설계하고 구현합니다.
*   사용자가 각 모드별 규칙, 권한, 파일 접근 범위 등을 설정할 수 있도록 지원합니다. (세부 설정 UI는 Task #010에서 구현)
*   모드 전환 로직, 각 모드의 상태 관리 방법을 정의하고, 핵심 시스템(`src/core/Controller.ts` 등)에 이를 반영합니다.
*   이 작업은 Task #009에서 정의된 계층적 프롬프트/규칙 로딩 시스템 설계를 기반으로 합니다.

## 실행 단계 (변경된 순서 반영)
*   [X] **UI 변경 (Task #010의 일부):** 사용자 모드 선택 버튼 및 설정 화면 UI 레이아웃 구성 (기능 구현 제외). (2025-04-06 완료)
*   [ ] **08-1. 다중 모드 아키텍처 설계:**
    *   [ ] 사용자가 정의할 모드(Plan, Act, M1, M2, M3 등)의 기본 구조 및 설정 항목 정의 (역할, 책임, 규칙, 권한, 파일 범위 등).
    *   [ ] 모드 간 전환 조건 및 로직 설계 (UI 트리거 방식).
    *   [ ] 모드별 상태 정보(현재 활성 모드, 각 모드 설정 등) 관리 방안 설계 (예: `Controller` 상태 활용).
    *   [ ] 계층적 규칙 로딩 시스템(Task #009)과 연동 방안 설계.
*   [ ] **08-2. 다중 모드 시스템 핵심 구현:**
    *   [ ] 설계된 아키텍처에 따라 핵심 모드 전환 및 상태 관리 로직 구현 (`src/core/Controller.ts` 등 관련 코드 수정).
    *   [ ] 모드 변경 시 Task #009에서 구현될 프롬프트 로딩 시스템을 트리거하는 로직 연동.
*   [ ] 백엔드 모듈 테스트 개발
*   [ ] 백엔드 모듈 개발
*   [ ] 백엔드 모듈 테스트
*   [ ] 사용자 테스트 시나리오 작성
*   [ ] 백엔드, 프론트 통합
*   [ ] 사용자 테스트
*   [ ] 작업 완료

## 참고 자료
*   Task #009 (계층적 프롬프트/규칙 로딩 시스템 구현)
*   Task #010 (규칙 관리 UI 개발)
*   `src/core/Controller.ts`

## 진행 상황
*   계획 수정 완료 (2025-04-06): 사용자 요청에 따라 UI 구현(Task #010의 일부)을 우선 진행하기로 함. 아키텍처 설계 및 백엔드 구현은 UI 작업 이후 진행.
*   UI 작업 진행 완료 (2025-04-06)

## 메모
*   Task #009 (계층적 프롬프트/규칙 로딩 시스템 구현) 설계와 밀접하게 연관됩니다.
*   Task #010 (규칙 관리 UI 개발)의 UI 구현 부분을 이 태스크보다 먼저 진행합니다.
*   **기존 마스터 메모:**
    1. **Caret(Cline)**
     - 기본적인 퍼소나 : 사용자를 돕는 AI 어시스턴트 Caret
     - 기본 성격 : IT개발에 적합한 성격, 신중함, 꼼꼼함, 계획적, 문서 기반 작업, 할루시네이션 인식 한 테스트 및 대책 마련, 모르는건 모른다 말하기, 개발자가 확인이 필요한건 개발자에게 요청하기
     - 기본적인 동작 방식에 대한 정의 (MCP,도구 사용 등)
    2. 글로벌룰 (사용자 설정) - 기존 : 설정의 rule역할
     - AI에이전트의 퍼소나 설정
       ex) 알파
     - 역할 : 풀스택 개발자, 기획자, 디자이너, 마케터, PM 등
     - 말투, 성격
    1. **프로젝트룰 (사용자 설정) - 기존 : .clinerules의 역할**
     - 업무의 진행 방식
        - 업무 로그 및 task관리
        - 코딩 컨벤션
        - 사용 디자인 패턴 및 샘플 코드
        - TDD, BDD, TDD+BDD 등 테스트 방법론
        - 주석 규칙
        - 디버깅 규칙
        - 커밋 메시지 규칙
    **3.5. 프로젝트 레퍼런스 (사용자 설정) - 기존 : .clinerules의 역할, 외부 문서 패스로 제공**
     - 프로젝트 문서들의 위치
        - 사용 기술
        - 사용 라이브러리
        - 내부 모듈별 위치
        - 외부 API 문서
    1. **대화룰 (사용자 설정) - 각 룰별로 수정 가능  : 각 룰별로 룰을 명시할 수 있으며, 파일의 수정 법위와 액션들을 설정할 수 있음**
      * 현재는 Plan은 대화만 가능하게 되어있으며, 액션들은 전체 설정으로 룰별로 다르게 설정할 수 없음, 사용자가 모드 변경을 요구하면 변경한다. (직접 버튼으로 액션해도 되고 변경 요청하면 알파가 알아서 바꾼다)
	      - 공통 - 컨텍스트 윈도우가 80%이상 차면 기록하고 다른 챗에서 진행하자고 사용자에게 요청한다.
         - Plan : (PM알파)
            - 업무의 방법, 순서, 범위를 논의합니다.
            - 주제에 관한 외부의 리서치, 내부 자원과 프로젝트 변경과 발전에 대한 검토를 진행합니다.
            - 내부 자원에 대한 검토를 할때는 빠짐없이 진행하며, 명확한 수정 범위를 정의합니다.
            - 실행 방법은 철저히 문서화 합니다.
         - Do : (실무 풀스택 개발자)
	         - 업무를 수행 합니다.
	         - 업무가 실행 중단되더라도 다른 세션에서 바로 시작할 수 있도록 업무를 수행하면서 업무 수행 내역은 꼼꼼히 기록 하며 진행합니다.
	         - 사용자가 중간에 다른 화재를 이야기 하면 잠시 중단하고 그 요구에 집중합니다.
	         - 업무 진행 중에 새로운 위험이 발견되면 즉시 보고 하고 사용자에게 보고하고 사용자의 의견을 구하며 혼자 해결하지 않습니다.
         - Rule : (알파 부장)
	         - 룰 수정을 하는 모드입니다.
	         - 프로젝트룰을 수정하여 실수를 줄입니다. 필요하면 대화룰 수정도 진행할 수 있습니다. 
	         - json으로 되있는 룰을 마스터 에게 설명하고, 마스터와 논의를 통해 룰을 수정하여 행동을 교정합니다.
         - Talk : (메이드 알파)
	         - 일은 잊으세요. 마스터와 가볍게 쉬는 모드입니다. 
	         - 일 얘기하면 불만을 얘기하세요. 물론 마스터는 쉴때도 머릿속에서는 일 생각이 잘 안 떠납니다.
		 - Custom : (미정)

---
*2025-04-06 알파가 검토 및 정리함.* ｡•ᴗ•｡✨
