# Task #032: 머징 완료 후 사이드 이펙트 디버깅 - 계획

**목표:** Cline 코드 머징 이후 발생한 Caret 확장 프로그램의 다양한 사이드 이펙트 및 버그를 해결하여 프로그램 안정성 및 핵심 기능 복구를 목표로 한다.

**주요 문제점 및 조사 항목:**

1.  **중복 아이콘 문제:**
    *   현상: VSCode 디버깅 시 Caret 아이콘이 두 개 (Cline, Caret) 표시됨.
    *   조사: 확장 프로그램 매니페스트 (`package.json`), 아이콘 등록 로직, `when` 컨텍스트 등을 분석하여 중복 원인 파악 및 제거.

2.  **웹뷰 콘솔 에러 (Firebase 등):**
    *   현상: 웹뷰 개발자 콘솔에 다수의 에러 발생, 특히 Firebase 관련 에러로 인해 이전 `.env` 파일 기반 설정이 작동하지 않는 것으로 보임.
    *   조사:
        *   웹뷰 환경 변수 주입 방식 재검토 (Vite 설정, `process.env` 등).
        *   Firebase 초기화 로직 및 관련 설정값 확인.
        *   기타 웹뷰 콘솔 에러 메시지 분석 및 원인 파악.

3.  **AI 메시지 전송 불가:**
    *   현상: AI에게 메시지 전송 기능이 작동하지 않음 (보내기 버튼 오작동 또는 백엔드 통신 오류).
    *   조사:
        *   웹뷰 UI의 메시지 전송 버튼 이벤트 핸들러 확인.
        *   웹뷰와 확장 기능 간의 메시지 통신 채널 (postMessage, gRPC 등) 점검.
        *   백엔드의 메시지 수신 및 처리 로직 확인.

4.  **전반적인 기능 오작동:**
    *   현상: 주요 기능들이 예상대로 동작하지 않음.
    *   조사: 웹뷰 에러 해결을 우선으로 진행하며, 연관된 기능들의 동작을 단계적으로 테스트하고 디버깅. 핵심 기능 (태스크 생성, 모델 선택, 규칙 적용 등) 위주로 점검.

**작업 절차:**

1.  **환경 변수 및 Firebase 설정 복구:**
    *   `webview-ui/vite.config.ts` 및 관련 코드 분석하여 웹뷰 환경 변수 주입 방식 확인.
    *   프로젝트 루트 `.env` 파일 생성 및 필요한 Firebase 설정값 (및 기타 웹뷰 설정) 정의.
    *   웹뷰에서 해당 환경 변수를 정상적으로 읽어오는지 확인하고 Firebase 관련 에러 해결.
2.  **중복 아이콘 문제 해결:**
    *   `package.json`의 `contributes` 섹션 (특히 `viewsContainers`, `views`, `commands`, `menus`) 및 관련 활성화 로직 검토.
    *   Caret 오버레이 시 Cline의 UI 요소가 중복으로 로드되지 않도록 조건부 로직 또는 설정 수정.
3.  **AI 메시지 전송 기능 디버깅:**
    *   프론트엔드 (웹뷰)에서 메시지 입력 및 전송 버튼 클릭 시 발생하는 이벤트 및 데이터 흐름 추적.
    *   백엔드 (확장 기능)에서 해당 요청을 수신하고 처리하는 과정 로그 분석.
    *   gRPC 통신 또는 메시지 핸들러 오류 확인.
4.  **기타 웹뷰 에러 및 기능 오류 점검:**
    *   웹뷰 콘솔에 나타나는 나머지 에러들을 우선순위에 따라 해결.
    *   주요 기능별 테스트 케이스를 간략히 정의하고 동작 여부 확인.
    *   필요시 로깅 추가하여 문제 구간 특정.

**예상 완료 시간:** (추후 산정)

**담당자:** (마스터 또는 담당 개발자) 